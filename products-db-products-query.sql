SELECT TP_TUOTEKOODI, TP_TOIMITTAJANRO, ROUND((TP_MYYNTIHINTA / 1.2), 2) MYYGIHIND, TP_NIMI, TV_VARASTOSSA, ROUND((TP_OSTOHINTA / 1.2), 2) OSTUHIND
FROM TUOTPER
LEFT JOIN TUOTVAIH ON TP_TUOTEKOODI = TV_TUOTEKOODI AND TP_TOIMITTAJANRO = TV_TOIMITTAJANRO
WHERE TP_ALEKOODI < 1900 AND TP_MYYNTIHINTA > 0 AND TP_OSTOHINTA > 0 AND TP_TOIMITTAJANRO IN (400, 544, 363, 225, 621, 124, 1224, 290, 272, 393, 451, 486, 1134, 272) AND TP_ALEKOODI NOT IN (1051, 1151, 1351, 1451, 1456, 1461, 1471)
ORDER BY TP_TUOTEKOODI ASC