SELECT TP_TUOTEKOODI, SUM(MYR_MAARA)
FROM MYYNTPER
LEFT JOIN MYYNTRIV ON MYP_MYYNTINRO=MYR_MYYNTINRO
LEFT JOIN TUOTPER ON MYR_TUOTEKOODI=TP_TUOTEKOODI AND MYR_TOIMITTAJANRO = TP_TOIMITTAJANRO
WHERE MYP_PVM BETWEEN '2019-6-1' AND '2019-12-31'
AND MYR_MAARA != 0
AND TP_ALEKOODI IN (1000, 1001, 1002, 1003, 1004, 1005, 1006, 1007, 1009, 1010, 1011, 1012, 1014, 1015, 1120, 1121, 1122, 1123, 1124, 1126, 1050)
GROUP BY TP_TUOTEKOODI
ORDER BY SUM(MYR_MAARA) DESC